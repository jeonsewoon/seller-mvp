<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0b0b0c">

  <link rel="manifest" href="./manifest.json">

  <title>뜻밖의시장 | 셀러 모집</title>

  <style>
    :root{
      --bg:#0b0b0c;
      --card:#16161a;
      --line:rgba(255,255,255,.12);
      --muted:#b2b2b8;
      --soft:rgba(255,255,255,.06);
      --soft2:rgba(255,255,255,.10);
    }
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Apple SD Gothic Neo","Noto Sans KR",sans-serif;
      background:var(--bg);
      color:#f4f4f6;
    }
    .wrap{max-width:860px;margin:0 auto;padding:22px 16px 92px}
    .heroTitle{
      font-size:36px;
      font-weight:900;
      letter-spacing:-0.02em;
      color:#fff;
      margin:6px 0 8px;
    }
    .heroSub{color:var(--muted);font-size:14px;margin:0 0 14px;line-height:1.5}
    .stepRow{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .stepTag{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:#d6d6db;
    }
    .card{
      margin-top:14px;
      padding:16px;
      border-radius:18px;
      background:var(--card);
      border:1px solid var(--line);
    }
    h2{font-size:16px;margin:0 0 10px}
    .muted{color:var(--muted);font-size:13px;line-height:1.55}
    .hr{height:1px;background:var(--line);margin:14px 0}
    label{display:block;font-size:12px;color:#d0d0d6;margin:10px 0 6px}
    input, select{
      width:100%;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.25);
      color:#fff;
      font-size:14px;
      outline:none;
    }
    input::placeholder{color:rgba(255,255,255,.35)}
    .grid{display:grid;grid-template-columns:1fr;gap:10px}
    @media(min-width:760px){ .grid{grid-template-columns:1fr 1fr} }

    .item{
      padding:14px;
      border-radius:14px;
      background:var(--soft);
      border:1px solid var(--line);
      margin-bottom:10px;
      cursor:pointer;
      transition:transform .06s ease;
    }
    .item:active{transform:scale(.99)}
    .item b{font-size:16px}
    .btnRow{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .btn{
      display:inline-block;
      border:0;
      padding:12px 14px;
      border-radius:14px;
      background:#fff;
      color:#000;
      font-weight:900;
      text-decoration:none;
      cursor:pointer;
    }
    .btn.sub{
      background:var(--soft2);
      color:#fff;
      font-weight:700;
      border:1px solid rgba(255,255,255,.16);
    }
    .tag{
      display:inline-block;
      font-size:11px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      color:#cfcfd3;
      background:rgba(255,255,255,.05);
      margin-left:8px;
    }
    .tag.ok{
      border-color:rgba(120,255,180,.22);
      color:rgba(170,255,205,.95);
      background:rgba(120,255,180,.06);
    }
    .selectedBox{
      padding:14px;
      border-radius:14px;
      background:rgba(255,255,255,.04);
      border:1px dashed rgba(255,255,255,.22);
    }
    .toast{
      position:fixed;
      left:50%;
      transform:translateX(-50%);
      bottom:16px;
      z-index:50;
      background:rgba(0,0,0,.80);
      border:1px solid rgba(255,255,255,.18);
      padding:10px 12px;
      border-radius:999px;
      font-size:13px;
      display:none;
      max-width:92vw;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .warn{
      margin-top:10px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(255,200,120,.22);
      background:rgba(255,200,120,.06);
      color:rgba(255,220,170,.95);
      font-size:13px;
      line-height:1.5;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="heroTitle">뜻밖의시장</div>
    <div class="heroSub">셀러 모집 · 메인 화면부터 단계별로 바로 지원까지 이어집니다.</div>

    <div class="stepRow">
      <div class="stepTag">1) 내 정보 저장(1회)</div>
      <div class="stepTag">2) 행사 선택</div>
      <div class="stepTag">3) 셀러 신청(구글폼)</div>
    </div>

    <!-- 1) 프로필 저장 -->
    <div class="card">
      <h2>1) 기존 셀러 정보 (한 번만 저장)</h2>
      <div class="muted">이 정보는 이 아이폰(기기)에 저장됩니다. 다음 신청부터 자동으로 채워져요.</div>

      <div class="hr"></div>

      <div class="grid">
        <div>
          <label>상호명 / 브랜드명 *</label>
          <input id="p_brand" placeholder="예) 출출빌라">
        </div>
        <div>
          <label>대표자 이름 *</label>
          <input id="p_owner" placeholder="예) 전세운">
        </div>
        <div>
          <label>휴대폰 번호 *</label>
          <input id="p_phone" inputmode="tel" placeholder="예) 010-1234-5678">
        </div>
        <div>
          <label>이메일 *</label>
          <input id="p_email" inputmode="email" placeholder="예) marketfindout@gmail.com">
        </div>
        <div>
          <label>판매 카테고리 *</label>
          <select id="p_category">
            <option value="">선택</option>
            <option value="푸드">푸드</option>
            <option value="디저트">디저트</option>
            <option value="수공예">수공예</option>
            <option value="라이프스타일">라이프스타일</option>
            <option value="기타">기타</option>
          </select>
        </div>
        <div>
          <label>인스타그램 계정 (선택)</label>
          <input id="p_insta" placeholder="예) @brandname">
        </div>
      </div>

      <div class="btnRow">
        <button class="btn" id="saveProfile">내 정보 저장</button>
        <button class="btn sub" id="clearProfile">저장 삭제</button>
        <span class="tag" id="profileStatus">저장 안됨</span>
      </div>
    </div>

    <!-- 2) 행사 선택 -->
    <div class="card">
      <h2>2) 행사 선택</h2>
      <div class="muted">아래 행사 중 하나를 눌러 선택하세요.</div>

      <div class="hr"></div>

      <div class="item" onclick="selectEvent('dt1','동탄역 롯데캐슬','2026-01-10 ~ 01-11','동탄')">
        <b>동탄역 롯데캐슬</b>
        <span class="tag ok" id="done-dt1" style="display:none">신청완료</span><br>
        <span class="muted">2026-01-10 ~ 01-11 · 동탄</span>
      </div>

      <div class="item" onclick="selectEvent('yi1','용인 죽전 힐스테이트','2026-01-24 ~ 01-25','용인')">
        <b>용인 죽전 힐스테이트</b>
        <span class="tag ok" id="done-yi1" style="display:none">신청완료</span><br>
        <span class="muted">2026-01-24 ~ 01-25 · 용인</span>
      </div>

      <div class="hr"></div>

      <div class="selectedBox">
        <b id="selName">선택된 행사 없음</b><br>
        <span class="muted" id="selMeta"></span>
      </div>

      <div class="btnRow">
        <button class="btn" id="applyBtn">3) 이 행사로 지원하기</button>
        <button class="btn sub" id="markDoneBtn">신청완료 표시/해제</button>
      </div>

      <div class="warn">
        ✅ 지금 단계 목표: “메인 UI가 그대로 보이고, 단계가 흐트러지지 않는지” 확인<br>
        - 자동입력(entry)은 다음 단계에서 연결해도 됩니다.<br>
        - 우선은 버튼 누르면 구글폼이 정상으로 열리면 성공이에요.
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

<script>
  /***************
   * 전세운님이 바꿀 곳: 구글폼 주소 1개만!
   ***************/
  const SELLER_FORM_BASE =
    "https://docs.google.com/forms/d/e/1FAIpQLScbJPOJKWT_rNJaBsx81N86KelknR7EaWQ_dPvoGcXEcDTSSg/viewform";

  // (다음 단계) 자동입력 entry 연결은 아직 안 붙여도 됨
  // const ENTRY = { event:"entry.123", brand:"entry.456", ... };

  /***************
   * 내부 로직 (건드릴 필요 없음)
   ***************/
  const LS_PROFILE = "um_profile_v1";
  const LS_DONE = "um_done_v1";

  const $ = (id) => document.getElementById(id);
  const toastEl = $("toast");
  const toast = (msg) => {
    toastEl.textContent = msg;
    toastEl.style.display = "block";
    clearTimeout(window.__t);
    window.__t = setTimeout(()=> toastEl.style.display="none", 2000);
  };

  function loadProfile(){
    try { return JSON.parse(localStorage.getItem(LS_PROFILE)) || null; }
    catch { return null; }
  }
  function saveProfile(p){
    localStorage.setItem(LS_PROFILE, JSON.stringify(p));
    refreshProfileUI();
  }
  function clearProfile(){
    localStorage.removeItem(LS_PROFILE);
    refreshProfileUI();
  }
  function refreshProfileUI(){
    const p = loadProfile();
    const tag = $("profileStatus");
    if (!p){
      tag.textContent = "저장 안됨";
      tag.className = "tag";
      ["p_brand","p_owner","p_phone","p_email","p_insta"].forEach(k => $(k).value = "");
      $("p_category").value = "";
      return;
    }
    tag.textContent = "저장됨";
    tag.className = "tag ok";
    $("p_brand").value = p.brand || "";
    $("p_owner").value = p.owner || "";
    $("p_phone").value = p.phone || "";
    $("p_email").value = p.email || "";
    $("p_category").value = p.category || "";
    $("p_insta").value = p.insta || "";
  }

  function loadDone(){ try { return JSON.parse(localStorage.getItem(LS_DONE)) || {}; } catch { return {}; } }
  function isDone(id){ return !!loadDone()[id]; }
  function setDone(id, val){
    const d = loadDone();
    if (val) d[id] = true; else delete d[id];
    localStorage.setItem(LS_DONE, JSON.stringify(d));
    refreshDoneBadges();
  }
  function refreshDoneBadges(){
    ["dt1","yi1"].forEach(id=>{
      const el = document.getElementById("done-"+id);
      if (!el) return;
      el.style.display = isDone(id) ? "inline-block" : "none";
    });
  }

  let selected = null;
  window.selectEvent = (id, name, date, area) => {
    selected = { id, name, date, area };
    $("selName").textContent = name;
    $("selMeta").textContent = `${date} · ${area}`;
    toast("행사를 선택했어요");
  };

  $("saveProfile").addEventListener("click", () => {
    const p = {
      brand: $("p_brand").value.trim(),
      owner: $("p_owner").value.trim(),
      phone: $("p_phone").value.trim(),
      email: $("p_email").value.trim(),
      category: $("p_category").value.trim(),
      insta: $("p_insta").value.trim()
    };
    if (!p.brand || !p.owner || !p.phone || !p.email || !p.category){
      toast("필수 항목(상호/이름/전화/이메일/카테고리)을 채워주세요");
      return;
    }
    saveProfile(p);
    toast("내 정보 저장 완료 ✅");
  });

  $("clearProfile").addEventListener("click", () => {
    clearProfile();
    toast("저장 삭제됨");
  });

  $("markDoneBtn").addEventListener("click", () => {
    if (!selected){ toast("먼저 행사를 선택해 주세요"); return; }
    setDone(selected.id, !isDone(selected.id));
    toast(isDone(selected.id) ? "신청완료 표시 ✅" : "신청완료 해제");
  });

  $("applyBtn").addEventListener("click", (e) => {
    e.preventDefault();
    if (!selected){ toast("먼저 행사를 선택해 주세요"); return; }
    const p = loadProfile();
    if (!p){ toast("먼저 1) 내 정보 저장을 해주세요"); return; }

    // MVP 1단계: 우선 폼이 열리면 성공 (자동입력은 다음 단계)
    setDone(selected.id, true);
    toast("구글폼으로 이동합니다…");
    window.location.href = SELLER_FORM_BASE;
  });

  // 초기화
  refreshProfileUI();
  refreshDoneBadges();
</script>
</body>
</html>
